<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.0</version>
    <template_groups>
        <template_group>
            <uuid>a571c0d144b14fd4a87a9d9b2aa9fcd6</uuid>
            <name>Templates/Applications</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>99a35e3a0b584344b551616516030e71</uuid>
            <template>FF Bird2</template>
            <name>FF Bird2</name>
            <description>https://github.com/chpoqxie/zbx-bird2</description>
            <groups>
                <group>
                    <name>Templates/Applications</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>c7f545031c8a48e68911f949c88c35a3</uuid>
                    <name>Bird: query socket</name>
                    <key>bird.socket</key>
                    <history>0</history>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                </item>
                <item>
                    <uuid>2791471c9f574a1e86c79a80426219d9</uuid>
                    <name>Bird alive</name>
                    <type>ZABBIX_ACTIVE</type>
                    <key>proc.num[bird,bird]</key>
                    <history>90d</history>
                    <triggers>
                        <trigger>
                            <uuid>4919a4fe707648318c0fef30bd05d3ea</uuid>
                            <expression>last(/FF Bird2/proc.num[bird,bird])&lt;&gt;1</expression>
                            <name>Bird is dead</name>
                            <priority>HIGH</priority>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>4fceaa3a64444354a20f4b6f7aa5f182</uuid>
                    <name>Bird Protocols Discovery</name>
                    <type>DEPENDENT</type>
                    <key>bird.protocols.discovery</key>
                    <delay>0</delay>
                    <filter>
                        <conditions>
                            <condition>
                                <macro>{#PROTO}</macro>
                                <value>{$PROTO.MATCH}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#PROTO}</macro>
                                <value>{$PROTO.NOT_MATCH}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>3d</lifetime>
                    <enabled_lifetime_type>DISABLE_NEVER</enabled_lifetime_type>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>9d0e03ab85dd4d63bbb9d40ca356a668</uuid>
                            <name>Bird: Protocol {#PROTO} info section</name>
                            <type>DEPENDENT</type>
                            <key>bird.proto.info[{#PROTO}]</key>
                            <delay>0</delay>
                            <history>0</history>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$..[?(@.name=='{#PROTO}')].first()</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.socket</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>b6e2cb3d4fbe4ec081e36167ecdba79e</uuid>
                            <name>Bird: {#PROTO} export_updates_accepted</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},export_updates_accepted]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.export_updates_accepted</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>073ccb566cec4105a890575570f3ec07</uuid>
                                    <expression>last(/FF Bird2/bird.protocols[{#PROTO},export_updates_accepted])&lt;{$ROUTES_EXP:&quot;{#PROTO}&quot;}</expression>
                                    <name>Too few exported routes to {#PROTO}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0915d6bd48f1439f96b70362a8880cd0</uuid>
                            <name>Bird: {#PROTO} export_updates_filtered</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},export_updates_filtered]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.export_updates_filtered</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6a5d2aaebf7341e5be2ba2d7db8d84af</uuid>
                            <name>Bird: {#PROTO} export_updates_received</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},export_updates_received]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.export_updates_received</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a263d1798fc54ad696d22b7357c8b20d</uuid>
                            <name>Bird: {#PROTO} export_updates_rejected</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},export_updates_rejected]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.export_updates_rejected</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>678cbe489d8048859bf2ae008728a3aa</uuid>
                            <name>Bird: {#PROTO} export_withdraws_accepted</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},export_withdraws_accepted]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.export_withdraws_accepted</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>683fffaa8d2c4f3d9fdb1420f1fddb0b</uuid>
                            <name>Bird: {#PROTO} export_withdraws_received</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},export_withdraws_received]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.export_withdraws_received</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>06954401e42948339f3647a9decf9e3d</uuid>
                            <name>Bird: {#PROTO} import_updates_accepted</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_updates_accepted]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_updates_accepted</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>09834780749d46d6abe0af304f8a6a0e</uuid>
                                    <expression>last(/FF Bird2/bird.protocols[{#PROTO},import_updates_accepted])&lt;{$ROUTES_IMP:&quot;{#PROTO}&quot;}</expression>
                                    <name>Too few imported routes from {#PROTO}</name>
                                    <priority>WARNING</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a68ea9f7eedd4868aeb65e426aeeca5f</uuid>
                            <name>Bird: {#PROTO} import_updates_filtered</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_updates_filtered]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_updates_filtered</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1627305100e84ecca87c4f993da50fc7</uuid>
                            <name>Bird: {#PROTO} import_updates_ignored</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_updates_ignored]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_updates_ignored</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1f4cad06a19447429e366be70c3b44db</uuid>
                            <name>Bird: {#PROTO} import_updates_received</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_updates_received]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_updates_received</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>bbc27304bc0746e3b784b3c0483100ec</uuid>
                            <name>Bird: {#PROTO} import_updates_rejected</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_updates_rejected]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_updates_rejected</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>29ad48f291fc4422afec57b0f5a74bf5</uuid>
                            <name>Bird: {#PROTO} import_withdraws_accepted</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_withdraws_accepted]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_withdraws_accepted</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a03b8372a85940d28fe14235aecc1920</uuid>
                            <name>Bird: {#PROTO} import_withdraws_ignored</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_withdraws_ignored]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_withdraws_ignored</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>af9a855eb0f9484eb5ab3dea6f532b14</uuid>
                            <name>Bird: {#PROTO} import_withdraws_received</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_withdraws_received]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_withdraws_received</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0c66827070604df1b8eb455e8e8c319a</uuid>
                            <name>Bird: {#PROTO} import_withdraws_rejected</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},import_withdraws_rejected]</key>
                            <delay>0</delay>
                            <history>7d</history>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.import_withdraws_rejected</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                        <item_prototype>
                            <uuid>18f9527df47f4323898077ef0a137e81</uuid>
                            <name>Bird: {#PROTO} state</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},state]</key>
                            <delay>0</delay>
                            <value_type>CHAR</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.state</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                            <trigger_prototypes>
                                <trigger_prototype>
                                    <uuid>f2e17f1885e642229059e2a104747be5</uuid>
                                    <expression>last(/FF Bird2/bird.protocols[{#PROTO},state])&lt;&gt;&quot;Established&quot;</expression>
                                    <name>Protocol {#PROTO} no longer Established</name>
                                    <priority>HIGH</priority>
                                    <manual_close>YES</manual_close>
                                </trigger_prototype>
                            </trigger_prototypes>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3c4ade4063314e5cb81c2d7aff2af6f7</uuid>
                            <name>Bird: {#PROTO} up</name>
                            <type>DEPENDENT</type>
                            <key>bird.protocols[{#PROTO},up]</key>
                            <delay>0</delay>
                            <value_type>BINARY</value_type>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.up</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>12h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>bird.proto.info[{#PROTO}]</key>
                            </master_item>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>bird.socket</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#PROTO}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.[*]</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$PROTO.MATCH}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$PROTO.NOT_MATCH}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
                <macro>
                    <macro>{$PROTO_STATE_TIME}</macro>
                    <value>15</value>
                    <description>How long (in minutes) after the protocol status changes should the trigger remain enabled?</description>
                </macro>
                <macro>
                    <macro>{$ROUTES_EXP}</macro>
                    <value>1</value>
                    <description>number of announced routes</description>
                </macro>
                <macro>
                    <macro>{$ROUTES_IMP}</macro>
                    <value>100000</value>
                    <description>number of accepted routes</description>
                </macro>
            </macros>
        </template>
    </templates>
</zabbix_export>
