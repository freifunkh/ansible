log syslog all;
router id 185.1.74.68;
define my_asn = 209347;
timeformat protocol iso long;

protocol device {
}

protocol direct {
	disabled;		# Disable by default
	# ipv4;			# Connect to default IPv4 table
	ipv6;			# ... and to default IPv6 table
	interface "dummy0";
}

protocol kernel {
	ipv6 {
		export where source ~ [RTS_BGP]; # we do not want to export the
		                                 # static unreachable route, so
		                                 # we do it like this as of now
		import none;
	};
	kernel table 2000;	# Kernel table to synchronize with (cix)
}

protocol static {
	ipv6;
	route 2a0a:4587:2030::/48 unreachable;
}

filter to_upstream6 {
	# CIX uses this community 57555:921:X = zu Region X announcen
	# DE-BER: X = 100
	# DE-FRA: X = 200
	bgp_large_community.add((57555, 921, 100));
	bgp_large_community.add((57555, 921, 200));

	if net ~ [2a0a:4587:2030::/48]
	then accept;
	else reject;
}

filter no_1und1 {
	if bgp_path.first = 8560
	then reject;
	else accept;
}

template bgp cix_peer6_ber {
	local 2001:7f8:a5::20:9347:2 as my_asn;
	hold time 90;
	password "eyohroK8uV2b";
	ipv6 {
		import keep filtered;
		import all; #filter no_1und1;
		#export none;
		export filter to_upstream6;
	};
}

protocol bgp cix1_ip6_ber from cix_peer6_ber {
	description "CIX Route Server 1 (BER, IPv6)";
	neighbor 2001:7f8:a5::5:7555:1 as 57555;
}

protocol bgp cix2_ip6_ber from cix_peer6_ber {
	description "CIX Route Server 2 (BER, IPv6)";
	neighbor 2001:7f8:a5::5:7555:2 as 57555;
}
